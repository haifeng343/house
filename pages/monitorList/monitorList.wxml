<wxs src="../../utils/filter.wxs" module="filter" />
<view>
  <view class="header {{!scrollIng ? '' : ''}}">
    <view class="top-nav'">
      <houseSelect id="houseSelect" type='monitor' checkInDate="{{checkInDate}}" checkOutDate="{{checkOutDate}}" cityName="{{cityName}}" budget="{{budget}}" locationName="{{locationName}}" bind:clickSelectItem='clickSelectItem'></houseSelect>
      <view class="bg_border"></view>
    </view>
    <view wx:if="{{countFlag === 1}}" class="house_detail">
      <view>总计:{{allCount}}套</view>
      <view>{{sortType == 1?'推荐价':'最低价'}}:¥{{lowPrice}}</view>
      <view class="check_detail" bindtap="goToDetail">
        <text>查看明细</text>
        <image class="check_more" src="../../assets/image/more.png"></image>
      </view>
    </view>
  </view>
  <view class="block"></view>
  <view class="card-list {{countFlag === 0||countFlag === 2 ? 'section_empty' : ''}}">
    <view class="search_empty" wx:if="{{countFlag===0&&bottomType === 1}}">
      <view class="search_view">
        <image class="monitor_empty_image" src="../../assets/image/monitor_empty.png"></image>
      </view>
      <view class="search_view search_title">暂时未监控符合条件的房源</view>
    </view>

    <view  class="search_empty" wx:if="{{countFlag === 2&&countBack}}">
      <noNetwork title="网络异常，请返回重试"></noNetwork>
    </view>
    <view  class="search_empty" wx:if="{{countFlag === 2&&!countBack}}">
      <noNetwork title="网络异常，请刷新重试"></noNetwork>
    </view>
    <view class="search_empty" wx:if="{{countFlag === 0&&bottomType ===2}}">
      <view class="search_view">
        <image class="empty_image" src="../../assets/image/search_empty.png"></image>
      </view>
      <view class="search_view search_title">未找到符合条件的房源</view>
      <view class="search_view search_tip">立即添加监控，第一时间推送房源信息，再也不怕心仪的房源擦肩而过</view>
    </view>
    <block wx:for="{{allData}}" wx:key="{{idx}}" wx:for-index="idx">
      <houseListCard item="{{item}}" type="{{2}}" idx="{{idx}}" isFirst="{{isFirst}}" isMonitorHouse="{{isMonitorHouse}}" dayCount="{{dayCount}}" bind:collectionEvent="goToCollection" bind:deleteEvent="delItem"></houseListCard>
    </block>
    <view class="no-more-data" wx:if="{{allData.length&&allData.length==allOriginalData.length}}">已展示全部房源</view>
    <mp-loading type="dot-red" tips="加载中" show="{{loadingShow}}"></mp-loading>
  </view>
  <view class="house_monitor" wx:if="{{countFlag===2&&countBack}}">
    <button class="monitor_btn" bindtap='goBack'>返回重试</button>
  </view>
  <view class="house_monitor" wx:if="{{countFlag===2&&!countBack}}">
    <button class="monitor_btn" bindtap='goRefresh'>立即刷新</button>
  </view>
  <view class="monit_start {{bottomType === 1?'monit_stop':''}}" wx:if="{{bottomType === 1&&loadingDisplay === 'none'}}">
    <view>
      <text class="time_line">监控时长:</text>
      <text class="price">{{taskTime}}</text>
      <text class="time_line">消费:</text>
      <text class="price">{{totalFee}}币</text>
      <text class="monit_btn" bindtap="stopMonitor">结束监控</text>
    </view>
  </view>
  <view class="monit_start {{bottomType === 2?'monit_save':''}}" wx:if="{{bottomType === 2&&loadingDisplay === 'none'}}">
    <view>
      <text class="monit_btn monit_back" bindtap="goBack">返回监控</text>
      <text class="monit_btn" bindtap="goSave">保存修改</text>
    </view>
  </view>
  <view wx:if="{{countFlag===1}}" class="house_shortcuts {{!scrollIng ? '' : 'hidden'}}">
    <view>
      <image bindtap="goTop" wx:if="{{scrollTop>500}}" class="top" src="../../assets/image/top.png"></image>
    </view>
    <view>
      <image bindtap="goSort"  class="sort" src="../../assets/image/sort.png"></image>
    </view>
  </view>


  
  <view class="house_loading" style="display:{{loadingDisplay}}" catchtouchmove="preventTouchMove">
    <image src="../../assets/image/loading.gif"></image>
  </view>

  <collectDialog bind:collectEvent="getcollectEventEvent" style="display:{{collectDisplay}}"></collectDialog>
  <stopDialog bind:stopEvent="getstopEventEvent" bind:stopConfrimEvent="getstopConfirmEventEvent" startTimeName="{{startTimeName}}" taskTime="{{taskTime}}" fee="{{fee}}" totalFee="{{totalFee}}" style="display:{{stopDisplay}}"></stopDialog>
  <updateMonitorDialog bind:updateCancelEvent="getUpdateCancelEvent" bind:updateConfrimEvent="getUpdateConfrimEvent" beginDate="{{beginDate}}" endDate="{{endDate}}" cityName="{{cityName}}" locationName="{{locationName}}" updateMinPrice="{{updateMinPrice}}"
    updateMaxPrice="{{updateMaxPrice}}" defaultBeginDate="{{defaultBeginDate}}" defaultEndDate="{{defaultEndDate}}" defaultCityName="{{defaultCityName}}" defaultLocationName="{{defaultLocationName}}" defaultMInPrice="{{defaultMInPrice}}" defaultMaxPrice="{{defaultMaxPrice}}"
    style="display:{{updateMonitorDisplay}}"></updateMonitorDialog>
  <block wx:if='{{isLoaded}}'>
    <advanceFilter class='{{showAdvance?"":"vhidden"}}' type='monitor' shownType='{{showAdvanceType}}' cityName='{{cityName}}' bind:submit='submitAdvance' />
  </block>

  <monitorEndDialog text="确认不再关注" bind:monitorEndEvent="getmonitorEndEvent" bind:monitorEndConfirmEvent="getmonitorEndConfirmEvent" style="display:{{monitorEndDisplay}}"></monitorEndDialog>

  <monitorEnoughDialog dialogTitle="{{dialogTitle}}" dialogText="{{dialogText}}" dialogBtn="{{dialogBtn}}" paddingBottom="1" style="display:{{monitorenoughDisplay}}" list="{{enoughList}}" bind:enoughEvent="getEnoughEvent" ></monitorEnoughDialog>

</view>